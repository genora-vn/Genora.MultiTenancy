@page
@using Genora.MultiTenancy.Localization
@using Genora.MultiTenancy.Web.Pages.AppMembershipTiers
@using Microsoft.Extensions.Localization
@using Volo.Abp.AspNetCore.Mvc.UI.Bootstrap.TagHelpers.Modal
@model EditModalModel
@inject IStringLocalizer<MultiTenancyResource> L
@{
    Layout = null;
}
<abp-dynamic-form abp-model="MembershipTier" asp-page="/AppMembershipTiers/EditModal">
    <abp-modal>
        <abp-modal-header title="@L["EditAppMembershipTier"].Value"></abp-modal-header>
        <abp-modal-body>
            <abp-input asp-for="Id" />
            <abp-form-content />
        </abp-modal-body>
        <abp-modal-footer buttons="@(AbpModalButtons.Cancel | AbpModalButtons.Save)"></abp-modal-footer>
    </abp-modal>
</abp-dynamic-form>
<script>
    document.querySelector('input[name="MembershipTier.MinTotalSpending"]').classList.add('thousand-separator');
    // Thêm định dạng dấu chấm ngăn cách hàng nghìn cho các input có class 'thousand-separator'
    document.querySelectorAll('.thousand-separator').forEach(function(input) {
        // Format khi load trang (display)
        if (input.value) {
            let num = parseFloat(input.value);
            if (!isNaN(num)) {
                input.value = num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 }).replace(/,/g, '.');
            }
        }

        // Format khi user nhập (on input)
        input.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\./g, ''); // Xóa dấu chấm cũ
            let num = parseFloat(value);
            if (!isNaN(num)) {
                e.target.value = num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 }).replace(/,/g, '.');
            } else if (value === '') {
                e.target.value = '';
            }
        });

        // Khi submit form, chuyển về dạng số thuần để model binding decimal hoạt động
        input.closest('form').addEventListener('submit', function() {
            input.value = input.value.replace(/\./g, '');
        });
    });
</script>